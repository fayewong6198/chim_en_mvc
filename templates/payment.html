{% extends 'base.html' %} {% block content %}
<!-- <div class="container">
  <div class="table-responsive text-nowrap">
    <h2>Your cart</h2>
    <table class="table">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Image</th>
          <th scope="col">Item title</th>
          <th scope="col">Price</th>
          <th scope="col">Quantity</th>
          <th scope="col">Total Item Price</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody>
        {% for order_item in object.items.all %}
        <tr class="ct-table-content">
          <th scope="row">{{ forloop.counter }}</th>
          <td><img height="64" src="{{ order_item.product.images.first }}" alt="{{ order_item.product.title }}" />
          </td>
          <td>{{ order_item.product.title }}</td>
          <td>{{ order_item.product.get_price }} vnđ</td>
          <td>
            <a style="color: #aaa;" href="{% url 'cart:descrease-quantity' order_item.id %}"><i
                class="fa fa-minus mr-2"></i></a>
            {{ order_item.quantity }}
            <a style="color: #aaa;" href="{% url 'cart:increase-quantity' order_item.id %}"><i
                class="fa fa-plus ml-2"></i></a>
          </td>
          <td>
            {% if order_item.item.discount_price %} ${{
                  order_item.get_total_discount_item_price }}
            <span class="badge badge-primary">Saving ${{ order_item.get_amount_saved }}</span>
            {% else %} {{ order_item.get_total_item_price }} vnđ{% endif %}
          </td>
          <td> <a style="color: red;" href="{% url 'cart:remove_from_cart' order_item.id %}">
              <i class="fa fa-close "></i>
            </a></td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5">Your cart is empty</td>
        </tr>
        <tr>
          <td colspan="5">
            <a class="btn btn-primary float-right" href="{% url 'cart:product-list' %}">Continue shopping</a>
          </td>
        </tr>
        {% endfor %} {% if object.coupon %}
        <tr>
          <td colspan="4"><b>Coupon</b></td>
          <td><b>-${{ object.coupon.amount }}</b></td>
        </tr>
        {% endif %} {% if object.get_total %}
        <tr>
          <td colspan="4"><b>Order Total</b></td>
          <td><b>${{ object.get_total }}</b></td>
        </tr>
        <tr>
          <td colspan="5">
            <a class="btn btn-warning float-right ml-2" href="/checkout/">Proceed to checkout</a>
            <a class="btn btn-primary float-right" href="/">Continue shopping</a>
          </td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
  {% if object.items.count > 0 %}
  <div class="row">
    <div class="col-md-4">
      <a href="{% url 'cart:product-list' %}" class="bold-text btn btn-outline-success">Continue Shopping</a>
    </div>

    <div class="col-md-8">
      <div class="row justify-content-end">
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-12 text-right border-bottom mb-5">
              <h3 class="text-black h4 text-uppercase">Cart Totals: {{object.get_total_price}} vnđ</h3>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</div> -->
<!--  -->

<!-- </div>

</div> -->
<div class="container wrapper">
  <div class="row cart-head">
    <div class="container">
      <div class="row">
        <p></p>
      </div>
      <div class="row">
        <div style="display: table; margin: auto;">
          <span class="step step_complete"> <a href="#" class="check-bc">Thong tin</a> <span
              class="step_line step_complete"> </span> <span class="step_line backline"> </span> </span>
          <span class="step step_complete"> <a href="#" class="check-bc">Checkout</a>

        </div>
      </div>
      <div class="row">
        <p></p>
      </div>
    </div>
  </div>

</div>

</main>

{% endblock content %}

{% block extra_scripts %}

<script nonce="">  // Create a Stripe client.
  var stripe = Stripe('');

  // Create an instance of Elements.
  var elements = stripe.elements();

  // Custom styling can be passed to options when creating an Element.
  // (Note that this demo uses a wider set of styles than the guide below.)
  var style = {
    base: {
      color: '#32325d',
      fontFamily: '"Helvetica Neue", Helvetica, sans-serif',
      fontSmoothing: 'antialiased',
      fontSize: '16px',
      '::placeholder': {
        color: '#aab7c4'
      }
    },
    invalid: {
      color: '#fa755a',
      iconColor: '#fa755a'
    }
  };

  // Create an instance of the card Element.
  var card = elements.create('card', { style: style });

  // Add an instance of the card Element into the card-element <div>.
  card.mount('#card-element');

  // Handle real-time validation errors from the card Element.
  card.addEventListener('change', function (event) {
    var displayError = document.getElementById('card-errors');
    if (event.error) {
      displayError.textContent = event.error.message;
    } else {
      displayError.textContent = '';
    }
  });

  // Handle form submission.
  var form = document.getElementById('stripe-form');
  form.addEventListener('submit', function (event) {
    event.preventDefault();

    stripe.createToken(card).then(function (result) {
      if (result.error) {
        // Inform the user if there was an error.
        var errorElement = document.getElementById('card-errors');
        errorElement.textContent = result.error.message;
      } else {
        // Send the token to your server.
        stripeTokenHandler(result.token);
      }
    });
  });

  // Submit the form with the token ID.
  function stripeTokenHandler(token) {
    // Insert the token ID into the form so it gets submitted to the server
    var form = document.getElementById('stripe-form');
    var hiddenInput = document.createElement('input');
    hiddenInput.setAttribute('type', 'hidden');
    hiddenInput.setAttribute('name', 'stripeToken');
    hiddenInput.setAttribute('value', token.id);
    form.appendChild(hiddenInput);

    // Submit the form
    form.submit();
  }

  var currentCardForm = $('.current-card-form');
  var newCardForm = $('.new-card-form');
  var use_default_card = document.querySelector("input[name=use_default_card]");
  use_default_card.addEventListener('change', function () {
    if (this.checked) {
      newCardForm.hide();
      currentCardForm.show()
    } else {
      newCardForm.show();
      currentCardForm.hide()
    }
  })

</script>

{% endblock extra_scripts %}